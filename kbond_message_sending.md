# KBond 자동 메시지 전송 가이드

KBond 메신저는 보안 및 관리자 권한 설정으로 인해 일반적인 Win32 메시지 전송 방식이 차단될 수 있습니다. 본 문서는 자동 메시지 전송을 위한 구현 방식과 실행 시 주의사항을 설명합니다.

## 1. 구현 방식 (`src/kbond_sender_test_robust.py`)

메시지 전송 스크립트는 다음과 같은 단계를 거쳐 동작합니다:

1.  **윈도우 식별**: 채팅창 클래스(`TfrmDccChat`)와 사용자 이름(예: '정민후')을 기준으로 대상 창을 찾습니다.
2.  **입력창(RichEdit) 검색**: 창 내의 여러 컨트롤 중 `ReadOnly` 속성이 없는 `RichEdit` 컨트롤을 입력창으로 판단합니다.
3.  **포커스 및 클릭**: 대상 창을 전면으로 가져오고(`set_focus`), 입력창을 직접 클릭(`click_input`)하여 물리적인 입력 준비를 마칩니다.
4.  **키 시뮬레이션**: `type_keys`를 사용하여 실제 키보드로 타이핑하는 것과 동일한 이벤트를 발생시켜 텍스트를 입력하고 `ENTER`를 전송합니다.

## 2. 필수 실행 조건 (중요)

KBond 메신저가 관리자 권한으로 실행되는 경우, 제어하는 파이썬 스크립트도 반드시 **관리자 권한**이 있어야 합니다. 그렇지 않을 경우 `Access Denied (WinError 5)` 오류가 발생하며 텍스트 입력이나 클릭이 무시됩니다.

### 실행 방법
1.  **관리자 권한 터미널** (PowerShell 또는 CMD)을 엽니다.
2.  프로젝트 디렉토리로 이동합니다:
    ```powershell
    cd C:\GitRepositories\messenger_reading
    ```
3.  스크립트를 실행합니다:
    ```powershell
    python src/kbond_sender_test_robust.py
    ```

## 3. 검증 방법

1.  **KBond 화면 확인**: '정민후' 대화창에 "자동메세지 테스트입니다"가 실제로 전송되었는지 확인합니다.
2.  **모니터링 로그 확인**: 실행 중인 `kbond_main.py` 콘솔이나 `output/` 폴더 내의 최신 로그 파일에 해당 메시지가 캡처되었는지 확인합니다.

## 4. 문제 해결 (Troubleshooting)

-   **창을 찾지 못함**: 해당 사용자와의 채팅창이 실제로 열려 있는지 확인하세요.
-   **텍스트가 입력되지 않음**: 터미널이 관리자 권한으로 실행되었는지 다시 확인하세요.
-   **한글 깨짐**: 스크립트 상단에 `# -*- coding: utf-8 -*-` 선언 및 `sys.stdout` 인코딩 설정이 되어 있는지 확인하세요.
