# 카카오톡 실시간 메시지 추출 프로그램

카카오톡 메시지를 실시간으로 감지하여 **0.5초 이내**에 TXT 파일로 저장하는 프로그램입니다.

## 🚀 주요 기능

- ⚡ **초고속 응답**: 메시지 감지 후 0.5초 이내 파일 저장
- 🔍 **실시간 모니터링**: UI Automation을 통한 실시간 메시지 감지
- 📝 **비동기 파일 쓰기**: 큐 기반 비동기 처리로 성능 최적화
- 📊 **성능 모니터링**: 응답 시간 추적 및 통계 제공
- ⚙️ **설정 가능**: JSON 파일을 통한 유연한 설정

## 📋 시스템 요구사항

- **OS**: Windows 10/11
- **Python**: 3.8 이상
- **카카오톡**: 최신 버전 권장
- **권한**: 일반 사용자 권한 (관리자 권한 필요 시 알림)

## 🔧 설치 방법

### 1. Python 패키지 설치

```bash
pip install -r requirements.txt
```

### 2. 설정 파일 확인

`config.json` 파일에서 설정을 조정할 수 있습니다:

```json
{
  "kakao": {
    "process_name": "KakaoTalk.exe",
    "window_title": "카카오톡",
    "monitoring_interval": 0.1
  },
  "output": {
    "directory": "output",
    "filename_format": "kakao_messages_{timestamp}.txt",
    "append_mode": true,
    "encoding": "utf-8"
  },
  "performance": {
    "use_async": true,
    "buffer_size": 100,
    "max_response_time": 0.5
  }
}
```

## 📖 사용 방법

### 기본 실행

```bash
python main.py
```

### 실행 순서

1. **카카오톡 실행**: 프로그램 실행 전에 카카오톡을 실행하세요
2. **대화방 열기**: 모니터링할 대화방을 열어두세요
3. **프로그램 시작**: `python main.py` 실행
4. **메시지 수신**: 새 메시지가 오면 자동으로 파일에 저장됩니다
5. **종료**: `Ctrl+C`로 프로그램을 종료하면 통계가 표시됩니다

## 📂 프로젝트 구조

```
messenger_reading/
├── src/
│   ├── __init__.py
│   ├── kakao_monitor.py         # UI Automation 기반 모니터링
│   ├── message_writer.py        # 비동기 파일 쓰기
│   └── performance_monitor.py   # 성능 측정
├── output/                      # 메시지 출력 폴더
├── config.json                  # 설정 파일
├── main.py                      # 메인 프로그램
├── requirements.txt             # Python 패키지
└── README.md
```

## ⚙️ 설정 옵션

### 모니터링 설정

- `monitoring_interval`: 모니터링 주기 (초, 기본값: 0.1)
  - 낮을수록 빠르지만 CPU 사용량 증가
  - 권장: 0.05 ~ 0.2

### 출력 설정

- `directory`: 출력 폴더 경로
- `filename_format`: 파일명 형식 (`{timestamp}` 사용 가능)
- `append_mode`: true = 추가 모드, false = 새 파일
- `encoding`: 파일 인코딩 (기본값: utf-8)

### 성능 설정

- `use_async`: 비동기 쓰기 사용 여부 (권장: true)
- `buffer_size`: 메시지 큐 크기
- `max_response_time`: 목표 응답 시간 (초)

## 📊 성능 통계

프로그램 종료 시 다음 통계가 표시됩니다:

```
📊 성능 통계
============================================================
총 메시지:        1,234개
평균 응답 시간:   45.23ms
최소 응답 시간:   12.34ms
최대 응답 시간:   234.56ms
P50 (중앙값):     42.10ms
P95:              123.45ms
P99:              198.76ms
목표 초과:        5회 (0.4%)
============================================================
```

## 🔍 작동 원리

### 1. UI Automation
- Windows UI Automation API를 사용하여 카카오톡 창의 UI 요소에 접근
- 메시지 텍스트를 실시간으로 읽어옴

### 2. 메시지 감지
- 짧은 간격(기본 0.1초)으로 카카오톡 창을 스캔
- 이전 스캔과 비교하여 새 메시지만 추출
- 해시값을 사용한 중복 방지

### 3. 비동기 처리
- 메시지를 큐에 추가 (즉시 반환)
- 별도 스레드에서 파일에 쓰기
- 0.5초 목표 달성을 위한 최적화

## ⚠️ 주의사항

### 카카오톡 버전
- UI 구조가 버전마다 다를 수 있음
- 최신 버전에서 테스트 권장

### 권한
- 일부 시스템에서 관리자 권한 필요 가능
- 필요 시 "관리자 권한으로 실행"

### 개인정보 보호
- 추출된 메시지는 민감한 개인정보일 수 있습니다
- 출력 파일을 안전하게 관리하세요
- 타인의 메시지를 무단으로 수집하지 마세요

### 성능
- 모니터링 간격을 너무 짧게 설정하면 CPU 사용량 증가
- 대화방이 많거나 메시지가 많으면 성능 저하 가능

## 🐛 문제 해결

### "카카오톡 프로세스를 찾을 수 없습니다"
- 카카오톡이 실행 중인지 확인
- 작업 관리자에서 KakaoTalk.exe 프로세스 확인

### "카카오톡 창을 찾을 수 없습니다"
- 카카오톡 창이 최소화되지 않았는지 확인
- 카카오톡을 재시작 후 다시 시도

### 메시지가 감지되지 않음
1. 대화방이 열려있는지 확인
2. `monitoring_interval` 값을 줄여보기 (예: 0.05)
3. 관리자 권한으로 실행
4. 카카오톡 UI 구조 변경 가능성 (업데이트 확인)

### 응답 시간이 0.5초 초과
1. `use_async`를 true로 설정
2. `monitoring_interval` 값 조정
3. 다른 프로그램 종료하여 시스템 부하 감소
4. SSD 사용 권장

## 🔄 향후 개선 계획

- [ ] 특정 대화방만 모니터링하는 기능
- [ ] 발신자 정보 추출
- [ ] 이미지/파일 메타데이터 추출
- [ ] 웹훅/API 연동
- [ ] GUI 인터페이스
- [ ] 다중 대화방 동시 모니터링

## 📝 라이선스

이 프로젝트는 교육 및 개인 사용 목적입니다.

## ⚖️ 법적 고지

- 이 프로그램은 개인적 용도로만 사용하세요
- 타인의 메시지를 무단으로 수집/저장하는 것은 불법일 수 있습니다
- 개인정보 보호법을 준수하세요
- 카카오톡 이용약관을 확인하세요
